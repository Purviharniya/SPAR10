{% extends 'main2.html' %} {% block content %}

<!-- add the content here -->

<style>
    #ratioInput,
    #sentenceInput {
        display: none;
    }

    .original-overflow {
        width: 100%;
        height: 350px;
        overflow-y: scroll;
        overflow-x: hidden;
    }
</style>

<div class="container-fluid">

    <div class="row">
        <div class="col-md-12 grid-margin stretch-card mt-2">
            <div class="card shadow pt-1 pb-5">
                <div class="card-body">
                    <div class="col-12 mb-3">
                        <h4 class="font-weight-bold text-purple mb-5">Paragraph Summarization:</h4>
                        {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                        {% for category,message in messages %}
                        {% if category == "success" %}
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        {% endif %}
                        {% if category == "error" %}
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        {% endif %}
                        {% endfor %}
                        {% endif %}
                        {% endwith %}
                        <form action="/para-summarization" enctype='multipart/form-data' method="POST"
                            name="parasum_form">
                            <div class="form-group">
                                <label for="file1">Upload the document/pdf containing the text: </label>
                                <input type="file" class="form-control-file" id="file1" name='file1'>
                            </div>
                            <div class="form-group">
                                <label for="or">OR</label>
                            </div>
                            <div class="form-group">
                                <label for="paratext">Enter the paragraph to be summarized:</label>
                                <textarea class="form-control" id="paratext" name='paratext' rows="5"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="select">Choose the option for summarizing the text:</label>
                                <select class="form-select" aria-label="select" name="options" id="options">
                                    <option value="0" selected>Select an option</option>
                                    <option value="1">Ratio</option>
                                    <option value="2">No. of sentences</option>
                                </select>
                            </div>
                            <div class="form-group" id="opinput">
                                <div class="ratioInput" id="ratioInput">
                                    <label for="ratio">Enter the ratio:</label>
                                    <input type="number" class="form-control" step=0.1 name="ratio"
                                        placeholder="e.g. 0.3">
                                </div>
                                <div class="sentenceInput" id="sentenceInput">
                                    <label for="num_sent">Enter the no. of sentences:</label>
                                    <input type="number" class="form-control" name="num_sent" placeholder="e.g. 3">
                                </div>
                            </div>
                            <input type="submit" class="btn btn-purple" value="Upload" name="resum_submit"
                                id='submitbtn'>
                            <input type="reset" class="btn btn-purple" value="Cancel" name="resum_reset">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="loadingModal" role="dialog">
        <div class="modal-dialog modal-dialog-centered">
            <!-- Modal content-->
            <div class="modal-content" style='background-color: rgb(245, 245, 245);'>
                <div class="modal-header">
                    <!-- <button type="button" class="close" data-dismiss="modal">Ã—</button> -->
                    <h4 class="modal-title"></h4>
                </div>
                <div class="modal-body">
                    <div>
                        <img src="../static/assets/loading.gif" class='img-responsive w-100' alt="loading gif">
                    </div>
                    <h3 class='text-center font-weight-bold'>Loading...</h3>
                </div>
                <div class="modal-footer">
                    <!-- <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
                </div>
            </div>

        </div>
    </div>

    <div class="row">
        <div class="col-md-12 grid-margin stretch-card mt-2">
            {% if result %}
            <div class="card shadow p-1 my-5">
                <div class="row">
                    <div class="col-12 text-purple text-center">
                        <h2 class="font-weight-bold">Results</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 py-3 text-justify overflow-auto">
                        <h4 class='text-purple font-weight-bold px-3'>Original Text:</h4>
                        <div class="original-overflow px-3">
                            <p>{{para_text}}</p>
                        </div>
                    </div>
                    <div class="col-md-6 py-3 text-justify overflow-auto">
                        <h4 class='text-purple font-weight-bold px-3'>Summarized Text:</h4>
                        <div class="original-overflow px-3">
                            <p>{{result}}</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $("select#options").change(function () {
            var selectedOption = $(this).children("option:selected").val();
            console.log("You have selected the option - " + selectedOption);

            if (selectedOption == 0) {
                $(".ratioInput").css('display', 'none');
                $(".sentenceInput").css('display', 'none');
            }

            //if selectedOption->1, toggle css display for ratioInput
            if (selectedOption == 1) {
                $(".ratioInput").css('display', 'block');
                $(".sentenceInput").css('display', 'none');
                // console.log("1 selected")
            }

            //if selectedOption->2, toggle css display for sentenceInput
            if (selectedOption == 2) {
                $(".sentenceInput").css('display', 'block');
                $(".ratioInput").css('display', 'none');
            }

        });
    });

    $(document).ready(function () {
        if (document.querySelector(".alert-danger") == null) {
            console.log("No danger alerts present")
            $("#submitbtn").click(function () {
                $("#loadingModal").modal({ backdrop: "static" });
            });
        }
    })

</script>
{% endblock %}